<?xml version="1.0" encoding="utf-8" ?>
<ContentView xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:local="clr-namespace:LojaApp.Views"
             x:Class="LojaApp.Views.SidebarView"
             x:Name="sidebarRoot">
    <ScrollView>
        <VerticalStackLayout Spacing="5" Padding="10">
            <!-- Sidebar Header/Logo -->
            <!-- <Image Source="dotnet_bot.png" HeightRequest="80" WidthRequest="80" HorizontalOptions="Center"  /> -->
            <Label Text="Gestor Zenith" FontSize="Title" FontAttributes="Bold" HorizontalOptions="Center" TextColor="White"/>
            <BoxView HeightRequest="1" Color="LightGray" Margin="0,10,0,10"/>

            <!-- Menu Items -->
            <StackLayout Padding="5" Spacing="8" BackgroundColor="Transparent" >

                <BoxView HeightRequest="1"  Color="LightGray" Margin="0,0,0,0"/>

                <CollectionView x:Name="SidebarCollection" ItemsSource="{Binding Buttons}" SelectionMode="None"  >
                    <CollectionView.ItemTemplate>
                        <DataTemplate >
                            <!-- Cartão do item -->
                            <Grid Margin="0,6" HeightRequest="90" >
                                <!-- Fundo ativo (vermelho) -->
                                <Frame x:Name="ActiveBg"
                               CornerRadius="10"
                               HasShadow="False"
                               Padding="12"
                               BackgroundColor="Transparent"/>

                                <!-- Conteúdo do cartão -->
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>

                                    <!-- Ícone dentro do círculo branco -->
                                    <Frame Grid.Row="0"
                                   WidthRequest="48" HeightRequest="48"
                                   CornerRadius="24"
                                   BackgroundColor="White"
                                   HorizontalOptions="Center"
                                   VerticalOptions="Center"
                                   HasShadow="False">
                                        <Image Source="{Binding Icon}" WidthRequest="24" HeightRequest="24" Aspect="AspectFit"/>
                                    </Frame>

                                    <!-- Texto -->
                                    <Label Grid.Row="1"
                                   Text="{Binding Title}"
                                   FontSize="12"
                                   HorizontalTextAlignment="Center"
                                   Margin="0,8,0,0"
                                   TextColor="#DDDDDD"/>
                                </Grid>

                                <!-- Clique -->
                                <Grid.GestureRecognizers>
                                    <TapGestureRecognizer 
                                    Command="{Binding Source={x:Reference SidebarCollection}, Path=BindingContext.ItemTappedCommand}"
                                    CommandParameter="{Binding .}" />
                                </Grid.GestureRecognizers>

                                <!-- Triggers de estado ativo -->
                                <Grid.Triggers>
                                    <DataTrigger TargetType="Grid" Binding="{Binding IsSelected}" Value="True">
                                        <Setter TargetName="ActiveBg" Property="BackgroundColor" Value="#B80F0F"/>
                                        <!-- vermelho -->
                                    </DataTrigger>
                                </Grid.Triggers>
                            </Grid>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>


                <!--<Rectangle HeightRequest="2" Fill="LightGray" WidthRequest="150"/>-->
                <BoxView HeightRequest="1" Color="LightGray" Margin="0,0,0,0"/>



            </StackLayout>


            <Button Text="Nova Venda" Style="{StaticResource SidebarMenuItemStyle}"  Clicked="OnMenuItemClicked" CommandParameter="Dashboard"  BackgroundColor="#BD3534"/>
            <Button Text=" Produtos" Style="{StaticResource SidebarMenuItemStyle}" Clicked="OnMenuItemClicked" CommandParameter="produtos" />
            <Button Text=" de Vendas" Style="{StaticResource SidebarMenuItemStyle}" Clicked="OnMenuItemClicked" CommandParameter="Profile" />
            <Button Text="Relatorios" Style="{StaticResource SidebarMenuItemStyle}" Clicked="OnMenuItemClicked" CommandParameter="About" />
            <Button Text="Gerenciar Estoque" Style="{StaticResource SidebarMenuItemStyle}" Clicked="OnMenuItemClicked" CommandParameter="Estoque" />
            <Button Text="Cadastrar Servico" Style="{StaticResource SidebarMenuItemStyle}" Clicked="OnMenuItemClicked" CommandParameter="Servico" />

            <!-- You can also use other layouts like CollectionView for dynamic menus -->
            <!-- <CollectionView ItemsSource="{Binding MenuItems}">
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Grid Padding="10">
                        <Label Text="{Binding Title}" />
                    </Grid>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView> -->
        </VerticalStackLayout>
    </ScrollView>
</ContentView>
